<div class="modal-header">
    <h2 class="modal-title">High Voltage Motor Controller</h2>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body">
    <h4>Introduction</h4>
    <p>For Senior Design Project, my team of five proposed our own project, developing a High Voltage Motor Controller. The project's goal was to develop a viable platform for controlling the in-hub electric motors used in collegiate competition solar cars, most notably the Mitsuba M2096-III. I joined this team as the simulation and application expert, having worked with these motors for several years as a critical member of Iowa State University's PRISUM Solar Car Team.</p>

	<p>Existing controllers for this motor consist of the OEM Mitsuba 2096C and the Prohelion (formally Tritium) Wavesculpter 22. Both of these controllers are incredibly expensive and notorious for having catastrophic failures happen at the worst of times.</p>

	<p>Technical Requirements:
	<ul>
	<li>RPM 0-900</li>
	<li>Input Voltage 48-135V</li>
	<li>Bus Current 50A</li>
	<li>Coil Current 200A</li>
	</ul>

    <div class="row justify-content-center mb-3">

        <div class="card m-2 px-0 shadow proj-desc-image">
            <div class="card-body">
                <h5 class="card-title">M2096 Kit</h5>
                <p class="card-text">Source: Nomura Co.</p>
            </div>
            <a target="_blank" href="images/seniordesign/M2096-3.jpg">
                <img src="images/seniordesign/M2096-3.jpg" class="card-img-bottom">
            </a>
        </div>

        <div class="card m-2 px-0 shadow shadow proj-desc-image">
            <div class="card-body">
                <h5 class="card-title">Wavesculpter 22</h5>
            </div>
            <a target="_blank" href="images/seniordesign/wavesculptor_22.png">
                <img src="images/seniordesign/wavesculptor_22.png" class="card-img-bottom">
            </a>
        </div>

        <div class="card m-2 px-0 shadow shadow proj-desc-image">
            <div class="card-body">
                <h5 class="card-title">M2096III Motor</h5>
            </div>
            <a target="_blank" href="images/seniordesign/M2096III_motor.jpg">
                <img src="images/seniordesign/M2096III_motor.jpg" class="card-img-bottom">
            </a>
        </div>

    </div>

    <h4>Development Board</h4>
	<p>Our project progress began by purchasing a off-the-shelf development board for a three phase inverter. For a development board we chose an ST-micro STSPIN32G0601 "600 V three-phase BLDC controller with embedded STM32 MCU". This development board had a very low current limit and a much higher voltage limit than was required, making it a useable but non-ideal choice. This board eventually suffered from an internal gate driver failure, killing the board, but we had already gained what experience we needed from it.</p>

	<div class="row justify-content-center mb-3">

        <div class="card m-2 px-0 shadow proj-desc-image">
            <div class="card-body">
                <h5 class="card-title">Development Board</h5>
            </div>
            <a target="_blank" href="images/seniordesign/dev_board.jpg">
                <img src="images/seniordesign/dev_board.jpg" class="card-img-bottom">
            </a>
        </div>

        <div class="card m-2 px-0 shadow shadow proj-desc-image">
            <div class="card-body">
                <h5 class="card-title">Test Setup</h5>
            </div>
            <a target="_blank" href="images/seniordesign/dev_board_test_setup.jpg">
                <img src="images/seniordesign/dev_board_test_setup.jpg" class="card-img-bottom">
            </a>
        </div>

    </div>

    <h4>Simulation</h4>
	<p>While Development Board testing was underway, I was busy creating an LTSpice testbench for evaluating gate driver and mosfet configurations. The testbench consisted of a 3-phase load consisting of resistor-inductor pairs in a Y configuration. The 6 gate drive signals are loaded in from time-value CSV files generated from a custom python script simulating a sinusoudal gate drive algorithm. Initially the full gate driver and mosfet chain was modeled, but this simulation was incredibly slow, so the gate drive characteristics (rise time, fall time, dead time, voltage) were recorded and then generated and used directly. This change made it possible to model many tens of milliseconds of activity and performance within a minute of real time, a vast improvement over the minutes per 100us acheived in the full path simulation.</p>

    <div class="row justify-content-center mb-3">

        <div class="card m-2 px-0 shadow proj-desc-image">
            <div class="card-body">
                <h5 class="card-title">Characterization Schematic</h5>
            </div>
            <a target="_blank" href="images/seniordesign/ltspice_characterization_complete.png">
                <img src="images/seniordesign/ltspice_characterization.png" class="card-img-bottom">
            </a>
        </div>

        <div class="card m-2 px-0 shadow shadow proj-desc-image">
            <div class="card-body">
                <h5 class="card-title">Characterization Waveform</h5>
            </div>
            <a target="_blank" href="images/seniordesign/characterization_full_waveform.png">
                <img src="images/seniordesign/characterization_full_waveform.png" class="card-img-bottom">
            </a>
        </div>

        <div class="card m-2 px-0 shadow proj-desc-image">
            <div class="card-body">
                <h5 class="card-title">Testbench Schematic</h5>
            </div>
            <a target="_blank" href="images/seniordesign/ltspice_full_tb.png">
                <img src="images/seniordesign/ltspice_full_tb.png" class="card-img-bottom">
            </a>
        </div>

        <div class="card m-2 px-0 shadow shadow proj-desc-image">
            <div class="card-body">
                <h5 class="card-title">Testbench Waveform</h5>
            </div>
            <a target="_blank" href="images/seniordesign/tb_full_waveform.png">
                <img src="images/seniordesign/tb_full_waveform.png" class="card-img-bottom">
            </a>
        </div>

    </div>

    <h4>Our Design</h4>
    <p>After completing preliminary work we began designing the final product. To simplify design and assembly, we broke the design into two stacked PCBs. The lower PCB (the Power Board) contains all the high-power circuitry, and the upper PCB (the Logic Board) contains the logic and isolation.</p>

    <h5>The Power Board</h5>
    <p>The Power Board consists of three identical half-bridge drivers and the power input terminals. The physical layout of this board was chosen to be similar to that of the Wavesculpter 22, as we had access to spare heatsinks and mounting hardware for that board layout. For our power transistors we decided to use standard silicon MOSFETs due to the their high resilience and low cost. Each half-bridge has a total of 6 MOSFETs mounted on the reverse of the board such that they were in direct contect with the heatsink-mounted thermal pad. To drive the gates of the power transistors, each half-bridge had its own half-gate bridge driver powered from an isolated 12V supply. A large 10uF bootstrap capacitor was added to power the high-side of the driver when the output is high. Along with the primary drive circuitry, the Power Board contains a large number of 
    high-voltage decoupling capacitors and three hall-effect current sensors, two for the phases and one for the DC bus.</p>

    <h5>The Logic Board</h5>
    <p>The Logic Board is designed around a central microcontroller at its heart that runs the onboard software, communicates with the outside world, and outputs the six PWM gate drive signals. Power is supplied for all logic and non-output functions from an external 12V source that is protected against over-voltage, reverse-voltage, and over-current. This power source is converted to 5V for logic, isolated 12V for the gate drive circuitry, and isolated 5V for the digital isolators. This design used pre-packaged switching power supplies for ease of design, even though they were slightly more expensive than a discrete solution. The gate drive signals and the low-voltage power for the Power Board are electrically isolated from the majority of the Logic Board and all external interfaces for safety and to reduce the chances for ground loops or ground bounce. The onboard microcontroller interfaces with the outside world through CAN, User GPIO, and a Position HALL-effect Sensor Interface. As this is geared towards automotive, CAN is the protocol of choice for data communication, but one of the objectives of the project was to make it as accessible as possible. Having the GPIO controls for the user makes it much easier to get up and running without external infrastructure, so to emulate this the logic board contained an onboard potentiometer, 5 onboard buttons, and 4 LEDs. As the motor contains onboard HALL sensors, this is used by the logic board to provide accurate positioning information without the need for phase voltage monitoring as is required by sensorless control. While the three onboard sensors can only provide 60deg resolution, simple interpolation can be done in software.</p>

    <h4>Results</h4>
    <p>While our ability to fully test the board we created was limited by software delays and the unavailability of a Motor Dyno, In a zero-load configuration the motor was able to reach over 1000RPM, more than 10% above our target speed. Despite the continuous abuse the hardware faced from software errors and usage, there were no hardware failures. While no hardware failed, our first revision used high voltage capacitors that quickly degraded to the point where they were effectively non-functional. These were successfully replaced on the second revision.</p>

    <h4>Future improvements</h4>
    <p>After completing this project with my team over the course of two semesters, there are quite a few technical aspects that I would like to work on in the future if given the opportunity. Using a continuous power supply for the high-side gate drivers would simplify the gate driving logic software and allow continuous 100% PWM output at all speeds. While this would be costlier than a bootstrap capacitor, the project was well under the cost target and the benefits may be well worth it. Another improvement to this would be outout voltage and temperature sensing. While it would be incredibly useful to have these metrics,transferring analog signals across a voltage barrier is difficult, and it may be easier to move the microcontroller to the isolated domain and instead isolate the power input and CAN connection. I would also like to look into GaNFETs again, which we initially discounted due to cost and fragility concerns</p>

    <p>More information about this project can be seen on the ISU ECPE Senior Design website: <a target="_blank" href="https://sdmay25-26.sd.ece.iastate.edu/">https://sdmay25-26.sd.ece.iastate.edu/</a>.</p>
</div>